(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function i(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=i(n);fetch(n.href,s)}})();const v=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})(),k=v?Promise.resolve().then(function(){return B}):Promise.resolve().then(function(){return N});async function T(...e){return(await k).default(...e)}v?Promise.resolve().then(function(){return x}):Promise.resolve().then(function(){return M});v?Promise.resolve().then(function(){return I}):Promise.resolve().then(function(){return D});const A=async e=>{const t=await e.getFile();return t.handle=e,t};var E=async(e=[{}])=>{Array.isArray(e)||(e=[e]);const t=[];e.forEach((n,s)=>{t[s]={description:n.description||"Files",accept:{}},n.mimeTypes?n.mimeTypes.map(a=>{t[s].accept[a]=n.extensions||[]}):t[s].accept["*/*"]=n.extensions||[]});const i=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:t,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),r=await Promise.all(i.map(A));return e[0].multiple?r:r[0]},B={__proto__:null,default:E};function w(e){function t(i){if(Object(i)!==i)return Promise.reject(new TypeError(i+" is not an object."));var r=i.done;return Promise.resolve(i.value).then(function(n){return{value:n,done:r}})}return w=function(i){this.s=i,this.n=i.next},w.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(i){var r=this.s.return;return r===void 0?Promise.resolve({value:i,done:!0}):t(r.apply(this.s,arguments))},throw:function(i){var r=this.s.return;return r===void 0?Promise.reject(i):t(r.apply(this.s,arguments))}},new w(e)}const S=async(e,t,i=e.name,r)=>{const n=[],s=[];var a,o=!1,c=!1;try{for(var u,d=function(l){var f,p,y,h=2;for(typeof Symbol<"u"&&(p=Symbol.asyncIterator,y=Symbol.iterator);h--;){if(p&&(f=l[p])!=null)return f.call(l);if(y&&(f=l[y])!=null)return new w(f.call(l));p="@@asyncIterator",y="@@iterator"}throw new TypeError("Object is not async iterable")}(e.values());o=!(u=await d.next()).done;o=!1){const l=u.value,f=`${i}/${l.name}`;l.kind==="file"?s.push(l.getFile().then(p=>(p.directoryHandle=e,p.handle=l,Object.defineProperty(p,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>f})))):l.kind!=="directory"||!t||r&&r(l)||n.push(S(l,t,f,r))}}catch(l){c=!0,a=l}finally{try{o&&d.return!=null&&await d.return()}finally{if(c)throw a}}return[...(await Promise.all(n)).flat(),...await Promise.all(s)]};var _=async(e={})=>{e.recursive=e.recursive||!1,e.mode=e.mode||"read";const t=await window.showDirectoryPicker({id:e.id,startIn:e.startIn,mode:e.mode});return(await(await t.values()).next()).done?[t]:S(t,e.recursive,void 0,e.skipDirectory)},x={__proto__:null,default:_},F=async(e,t=[{}],i=null,r=!1,n=null)=>{Array.isArray(t)||(t=[t]),t[0].fileName=t[0].fileName||"Untitled";const s=[];let a=null;if(e instanceof Blob&&e.type?a=e.type:e.headers&&e.headers.get("content-type")&&(a=e.headers.get("content-type")),t.forEach((u,d)=>{s[d]={description:u.description||"Files",accept:{}},u.mimeTypes?(d===0&&a&&u.mimeTypes.push(a),u.mimeTypes.map(l=>{s[d].accept[l]=u.extensions||[]})):a?s[d].accept[a]=u.extensions||[]:s[d].accept["*/*"]=u.extensions||[]}),i)try{await i.getFile()}catch(u){if(i=null,r)throw u}const o=i||await window.showSaveFilePicker({suggestedName:t[0].fileName,id:t[0].id,startIn:t[0].startIn,types:s,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1});!i&&n&&n(o);const c=await o.createWritable();return"stream"in e?(await e.stream().pipeTo(c),o):"body"in e?(await e.body.pipeTo(c),o):(await c.write(await e),await c.close(),o)},I={__proto__:null,default:F},z=async(e=[{}])=>(Array.isArray(e)||(e=[e]),new Promise((t,i)=>{const r=document.createElement("input");r.type="file";const n=[...e.map(c=>c.mimeTypes||[]),...e.map(c=>c.extensions||[])].join();r.multiple=e[0].multiple||!1,r.accept=n||"",r.style.display="none",document.body.append(r);const s=c=>{typeof a=="function"&&a(),t(c)},a=e[0].legacySetup&&e[0].legacySetup(s,()=>a(i),r),o=()=>{window.removeEventListener("focus",o),r.remove()};r.addEventListener("click",()=>{window.addEventListener("focus",o)}),r.addEventListener("change",()=>{window.removeEventListener("focus",o),r.remove(),s(r.multiple?Array.from(r.files):r.files[0])}),"showPicker"in HTMLInputElement.prototype?r.showPicker():r.click()})),N={__proto__:null,default:z},O=async(e=[{}])=>(Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise((t,i)=>{const r=document.createElement("input");r.type="file",r.webkitdirectory=!0;const n=a=>{typeof s=="function"&&s(),t(a)},s=e[0].legacySetup&&e[0].legacySetup(n,()=>s(i),r);r.addEventListener("change",()=>{let a=Array.from(r.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(a=a.filter(o=>o.webkitRelativePath.split("/").every(c=>!e[0].skipDirectory({name:c,kind:"directory"})))):a=a.filter(o=>o.webkitRelativePath.split("/").length===2),n(a)}),"showPicker"in HTMLInputElement.prototype?r.showPicker():r.click()})),M={__proto__:null,default:O},q=async(e,t={})=>{Array.isArray(t)&&(t=t[0]);const i=document.createElement("a");let r=e;"body"in e&&(r=await async function(a,o){const c=a.getReader(),u=new ReadableStream({start:f=>async function p(){return c.read().then(({done:y,value:h})=>{if(!y)return f.enqueue(h),p();f.close()})}()}),d=new Response(u),l=await d.blob();return c.releaseLock(),new Blob([l],{type:o})}(e.body,e.headers.get("content-type"))),i.download=t.fileName||"Untitled",i.href=URL.createObjectURL(await r);const n=()=>{typeof s=="function"&&s()},s=t.legacySetup&&t.legacySetup(n,()=>s(),i);return i.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(i.href),3e4),n()}),i.click(),null},D={__proto__:null,default:q};const U=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],j=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],R=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],$=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],g=(e,t,i)=>{let r=e;return typeof t=="string"||Array.isArray(t)?r=e.toLocaleString(t,i):(t===!0||i!==void 0)&&(r=e.toLocaleString(void 0,i)),r};function b(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);t={bits:!1,binary:!1,space:!0,...t};const i=t.bits?t.binary?$:R:t.binary?j:U,r=t.space?" ":"";if(t.signed&&e===0)return` 0${r}${i[0]}`;const n=e<0,s=n?"-":t.signed?"+":"";n&&(e=-e);let a;if(t.minimumFractionDigits!==void 0&&(a={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(a={maximumFractionDigits:t.maximumFractionDigits,...a}),e<1){const d=g(e,t.locale,a);return s+d+r+i[0]}const o=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),i.length-1);e/=(t.binary?1024:1e3)**o,a||(e=e.toPrecision(3));const c=g(Number(e),t.locale,a),u=i[o];return s+c+r+u}const H=document.querySelector("#load-wasm");document.querySelector("#before-size");document.querySelector("#after-size");document.querySelector("#delta-size");const m=document.querySelector("#drop-area"),P=document.querySelector("#results-area"),Y=document.querySelector("#stats-template");async function C(e,t){const i=[];async function r(s){for(const[a,o]of s)try{i[a]=await o()}catch(c){i[a]=new Error(`Failed with: ${c.message}`)}}const n=new Array(t).fill(e.entries()).map(r);return await Promise.allSettled(n),i}const G="getAsFileSystemHandle"in DataTransferItem.prototype;H.addEventListener("click",async()=>{const e=await T({mimeTypes:["application/wasm"],extensions:[".wasm"],multiple:!0});!e||!e.length||L(e)});m.addEventListener("dragover",e=>{e.preventDefault()});m.addEventListener("dragenter",e=>{m.style.outline="solid red 1px"});m.addEventListener("dragleave",e=>{m.style.outline=""});m.addEventListener("drop",async e=>{e.preventDefault(),m.style.outline="";const t=[...e.dataTransfer.items].filter(r=>r.kind==="file").map(r=>G?r.getAsFileSystemHandle():r.getAsFile()),i=[];for await(const r of t){let n=r;r.kind==="file"&&(n=await r.getFile()),n.type==="application/wasm"&&i.push(n)}L(i)});const L=async e=>{P.innerHTML="";const t=[];for(const i of e){const r=Y.content.cloneNode(!0),n=r.querySelector(".file-name"),s=r.querySelector(".before-size"),a=r.querySelector(".after-size"),o=r.querySelector(".delta-size");n.textContent=i.name,s.textContent=b(i.size),P.append(r),t.push(()=>new Promise((c,u)=>{const d=new Worker(new URL("/assets/worker-a81f8b9c.js",self.location),{type:"module"});d.addEventListener("message",l=>{const{wasmFileAfter:f}=l.data;a.textContent=b(f.size);const p=f.size-i.size;o.textContent=`${(100-f.size/i.size*100).toFixed(2)}%`,p<0?o.classList.add("size-smaller"):p>=0&&o.classList.add("size-larger"),d.terminate(),c()}),d.postMessage({wasmFileBefore:i})}))}await C(t,3)};
