(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();const W="modulepreload",j=function(e){return"/wasmoptim/"+e},F={},v=function(t,r,n){if(!r||r.length===0)return t();const s=document.getElementsByTagName("link");return Promise.all(r.map(a=>{if(a=j(a),a in F)return;F[a]=!0;const i=a.endsWith(".css"),o=i?'[rel="stylesheet"]':"";if(!!n)for(let c=s.length-1;c>=0;c--){const u=s[c];if(u.href===a&&(!i||u.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${o}`))return;const d=document.createElement("link");if(d.rel=i?"stylesheet":W,i||(d.as="script",d.crossOrigin=""),d.href=a,document.head.appendChild(d),i)return new Promise((c,u)=>{d.addEventListener("load",c),d.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${a}`)))})})).then(()=>t()).catch(a=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=a,window.dispatchEvent(i),!i.defaultPrevented)throw a})},w=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})(),Z=w?Promise.resolve().then(function(){return Q}):Promise.resolve().then(function(){return ie});async function H(...e){return(await Z).default(...e)}const G=w?Promise.resolve().then(function(){return te}):Promise.resolve().then(function(){return oe});async function V(...e){return(await G).default(...e)}const Y=w?Promise.resolve().then(function(){return ne}):Promise.resolve().then(function(){return le});async function K(...e){return(await Y).default(...e)}const X=async e=>{const t=await e.getFile();return t.handle=e,t};var J=async(e=[{}])=>{Array.isArray(e)||(e=[e]);const t=[];e.forEach((s,a)=>{t[a]={description:s.description||"Files",accept:{}},s.mimeTypes?s.mimeTypes.map(i=>{t[a].accept[i]=s.extensions||[]}):t[a].accept["*/*"]=s.extensions||[]});const r=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:t,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),n=await Promise.all(r.map(X));return e[0].multiple?n:n[0]},Q={__proto__:null,default:J};function L(e){function t(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var n=r.done;return Promise.resolve(r.value).then(function(s){return{value:s,done:n}})}return L=function(r){this.s=r,this.n=r.next},L.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var n=this.s.return;return n===void 0?Promise.resolve({value:r,done:!0}):t(n.apply(this.s,arguments))},throw:function(r){var n=this.s.return;return n===void 0?Promise.reject(r):t(n.apply(this.s,arguments))}},new L(e)}const D=async(e,t,r=e.name,n)=>{const s=[],a=[];var i,o=!1,l=!1;try{for(var d,c=function(u){var m,p,f,h=2;for(typeof Symbol<"u"&&(p=Symbol.asyncIterator,f=Symbol.iterator);h--;){if(p&&(m=u[p])!=null)return m.call(u);if(f&&(m=u[f])!=null)return new L(m.call(u));p="@@asyncIterator",f="@@iterator"}throw new TypeError("Object is not async iterable")}(e.values());o=!(d=await c.next()).done;o=!1){const u=d.value,m=`${r}/${u.name}`;u.kind==="file"?a.push(u.getFile().then(p=>(p.directoryHandle=e,p.handle=u,Object.defineProperty(p,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>m})))):u.kind!=="directory"||!t||n&&n(u)||s.push(D(u,t,m,n))}}catch(u){l=!0,i=u}finally{try{o&&c.return!=null&&await c.return()}finally{if(l)throw i}}return[...(await Promise.all(s)).flat(),...await Promise.all(a)]};var ee=async(e={})=>{e.recursive=e.recursive||!1,e.mode=e.mode||"read";const t=await window.showDirectoryPicker({id:e.id,startIn:e.startIn,mode:e.mode});return(await(await t.values()).next()).done?[t]:D(t,e.recursive,void 0,e.skipDirectory)},te={__proto__:null,default:ee},re=async(e,t=[{}],r=null,n=!1,s=null)=>{Array.isArray(t)||(t=[t]),t[0].fileName=t[0].fileName||"Untitled";const a=[];let i=null;if(e instanceof Blob&&e.type?i=e.type:e.headers&&e.headers.get("content-type")&&(i=e.headers.get("content-type")),t.forEach((d,c)=>{a[c]={description:d.description||"Files",accept:{}},d.mimeTypes?(c===0&&i&&d.mimeTypes.push(i),d.mimeTypes.map(u=>{a[c].accept[u]=d.extensions||[]})):i?a[c].accept[i]=d.extensions||[]:a[c].accept["*/*"]=d.extensions||[]}),r)try{await r.getFile()}catch(d){if(r=null,n)throw d}const o=r||await window.showSaveFilePicker({suggestedName:t[0].fileName,id:t[0].id,startIn:t[0].startIn,types:a,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1});!r&&s&&s(o);const l=await o.createWritable();return"stream"in e?(await e.stream().pipeTo(l),o):"body"in e?(await e.body.pipeTo(l),o):(await l.write(await e),await l.close(),o)},ne={__proto__:null,default:re},ae=async(e=[{}])=>(Array.isArray(e)||(e=[e]),new Promise((t,r)=>{const n=document.createElement("input");n.type="file";const s=[...e.map(l=>l.mimeTypes||[]),...e.map(l=>l.extensions||[])].join();n.multiple=e[0].multiple||!1,n.accept=s||"",n.style.display="none",document.body.append(n);const a=l=>{typeof i=="function"&&i(),t(l)},i=e[0].legacySetup&&e[0].legacySetup(a,()=>i(r),n),o=()=>{window.removeEventListener("focus",o),n.remove()};n.addEventListener("click",()=>{window.addEventListener("focus",o)}),n.addEventListener("change",()=>{window.removeEventListener("focus",o),n.remove(),a(n.multiple?Array.from(n.files):n.files[0])}),"showPicker"in HTMLInputElement.prototype?n.showPicker():n.click()})),ie={__proto__:null,default:ae},se=async(e=[{}])=>(Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise((t,r)=>{const n=document.createElement("input");n.type="file",n.webkitdirectory=!0;const s=i=>{typeof a=="function"&&a(),t(i)},a=e[0].legacySetup&&e[0].legacySetup(s,()=>a(r),n);n.addEventListener("change",()=>{let i=Array.from(n.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(i=i.filter(o=>o.webkitRelativePath.split("/").every(l=>!e[0].skipDirectory({name:l,kind:"directory"})))):i=i.filter(o=>o.webkitRelativePath.split("/").length===2),s(i)}),"showPicker"in HTMLInputElement.prototype?n.showPicker():n.click()})),oe={__proto__:null,default:se},ce=async(e,t={})=>{Array.isArray(t)&&(t=t[0]);const r=document.createElement("a");let n=e;"body"in e&&(n=await async function(i,o){const l=i.getReader(),d=new ReadableStream({start:m=>async function p(){return l.read().then(({done:f,value:h})=>{if(!f)return m.enqueue(h),p();m.close()})}()}),c=new Response(d),u=await c.blob();return l.releaseLock(),new Blob([u],{type:o})}(e.body,e.headers.get("content-type"))),r.download=t.fileName||"Untitled",r.href=URL.createObjectURL(await n);const s=()=>{typeof a=="function"&&a()},a=t.legacySetup&&t.legacySetup(s,()=>a(),r);return r.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(r.href),3e4),s()}),r.click(),null},le={__proto__:null,default:ce};const I="/wasmoptim/spinner.svg",de="getUniqueId"in FileSystemHandle.prototype,ue=async(e,t)=>{const r=[],n=async a=>{for(const[i,o]of a)try{r[i]=await o()}catch(l){r[i]=new Error(`Failed with: ${l.message}`)}},s=new Array(t).fill(e.entries()).map(n);return await Promise.allSettled(s),r},xe=(e,t)=>{let r;return function(...s){const a=()=>{clearTimeout(r),e(...s)};clearTimeout(r),r=setTimeout(a,t)}},me=async e=>{const t=[],r=async s=>{const a=await new Promise(i=>s.readEntries(i));await Promise.all(a.map(async i=>{i.isDirectory?await r(i.createReader()):t.push(i)}))},n=e.createReader();return await r(n),t},O=async(e,t,r=e.name,n)=>{const s=[],a=[];for await(const i of e.values()){const o=`${r}/${i.name}`;i.kind==="file"?a.push(i.getFile().then(l=>(l.directoryHandle=e,l.handle=i,Object.defineProperty(l,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>o})))):i.kind==="directory"&&t&&s.push(O(i,t,o))}return[...(await Promise.all(s)).flat(),...await Promise.all(a)]},fe=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],pe=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],ye=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],he=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],q=(e,t,r)=>{let n=e;return typeof t=="string"||Array.isArray(t)?n=e.toLocaleString(t,r):(t===!0||r!==void 0)&&(n=e.toLocaleString(void 0,r)),n};function E(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);t={bits:!1,binary:!1,space:!0,...t};const r=t.bits?t.binary?he:ye:t.binary?pe:fe,n=t.space?" ":"";if(t.signed&&e===0)return` 0${n}${r[0]}`;const s=e<0,a=s?"-":t.signed?"+":"";s&&(e=-e);let i;if(t.minimumFractionDigits!==void 0&&(i={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(i={maximumFractionDigits:t.maximumFractionDigits,...i}),e<1){const c=q(e,t.locale,i);return a+c+n+r[0]}const o=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),r.length-1);e/=(t.binary?1024:1e3)**o,i||(e=e.toPrecision(3));const l=q(Number(e),t.locale,i),d=r[o];return a+l+n+d}const we=document.querySelector("#load-wasm"),ge=document.querySelector("#load-directory"),g=document.querySelector("#drop-area"),S=document.querySelector("#results-area"),ve=document.querySelector("#total-delta-size"),be=document.querySelector("#stats-template"),Se=document.querySelector("#example-template"),ke=document.querySelector("#stats-header"),N=document.querySelector("#select-all-checkbox"),R=document.querySelector("#overwrite-checkbox"),Ee=document.querySelector("#observe-changes-checkbox"),C=document.querySelector("#examples-list"),z="setAppBadge"in navigator,P=new Map;let A=0;const k=async e=>{ke.hidden=!1,S.closest("table").hidden=!1;const t=[];for(const r of e){const n=de&&r.handle?await r.handle.getUniqueId():r.name;let s,a,i,o,l;const d=S.querySelector(`[data-uuid="${n}"]`);if(d){const c=d.closest("tr");s=c.querySelector(".file-name"),a=c.querySelector(".before-size"),i=c.querySelector(".after-size"),o=c.querySelector(".delta-size"),l=c.querySelector(".spinner")}else{const c=be.content.cloneNode(!0);s=c.querySelector(".file-name"),a=c.querySelector(".before-size"),i=c.querySelector(".after-size"),o=c.querySelector(".delta-size"),l=c.querySelector(".spinner"),S.append(c)}l.src=I,s.querySelector("code").textContent=r.name,s.classList.add("processing"),z&&navigator.setAppBadge(++A),a.textContent=E(r.size),s.dataset.uuid=n,t.push(()=>new Promise((c,u)=>{const m=new Worker(new URL("/wasmoptim/assets/binaryen-worker-pmD4DJqu.js",import.meta.url));m.addEventListener("message",async p=>{m.terminate(),l.removeAttribute("src"),s.classList.remove("processing"),z&&(navigator.setAppBadge(--A),A===0&&navigator.clearAppBadge());const{wasmFileAfter:f,error:h}=p.data;if(h){u(h),s.classList.add("error"),i.classList.add("error"),o.classList.add("error"),i.textContent=h.name,o.textContent=h.message;return}i.textContent=E(f.size);const b=f.size-r.size;console.log(`${r.name} processed → Before: ${r.size} After: ${f.size} Delta: ${b}`);const _=Math.abs(100-f.size/r.size*100).toFixed(2);o.textContent=Number(_)===0?"no change":`${_}% ${b<0?"smaller":"larger"}`,o.classList.add(Number(_)===0?"size-larger":b<0?"size-smaller":"size-larger"),P.set(n,{file:f,handle:r.handle,savings:b});const B=Array.from(P.values()).map(y=>y.savings).reduce((y,T)=>y+T,0),U=B/P.size;if(ve.textContent=`Saved ${E(Math.abs(B))} in total and ${E(Math.abs(U))} per file on average.`,b<0&&x&&w&&R.checked&&r.handle)try{const y=await r.handle.createWritable();await y.write(f),await y.close()}catch(y){console.error(y.name,y.message)}if($&&Ee.checked&&r.handle){const{getFileSystemChangeObserver:y}=await v(()=>import("./file-system-observer-Q3Q1vaay.js"),__vite__mapDeps([]));y().observe(r.handle),console.log(`${r.name} → Observing changes`)}c()}),m.postMessage({wasmFileBefore:r})}))}await ue(t,"hardwareConcurrency"in navigator?Math.floor(navigator.hardwareConcurrency):4)},Le=async e=>{for(const t of e)await t.handle.requestPermission({mode:"readwrite"})},Pe=["https://unpkg.com/canvaskit-wasm@0.39.1/bin/canvaskit.wasm","https://unpkg.com/zxing-wasm@1.0.0-rc.4/dist/full/zxing_full.wasm","https://unpkg.com/@sqlite.org/sqlite-wasm@3.44.0-build1/sqlite-wasm/jswasm/sqlite3.wasm","https://unpkg.com/@tensorflow/tfjs-backend-wasm@4.13.0/wasm-out/tfjs-backend-wasm.wasm"],_e=/@(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?/;Pe.forEach(e=>{const t=Se.content.cloneNode(!0),r=t.querySelector("code"),n=t.querySelector("a");r.textContent=e.replace("https://unpkg.com/","").replace(_e,""),n.href=e,C.append(t)});C.addEventListener("click",async e=>{if(e.target.nodeName.toLowerCase()!=="code")return;e.preventDefault();const t=e.target.closest("a"),r=t.href,n=t.parentNode.querySelector(".downloading");n.hidden=!1;const s=t.parentNode.querySelector("img");s.src=I;const a=await fetch(r).then(o=>o.blob());s.removeAttribute("src"),n.hidden=!0;const i=new File([a],r.split("/").pop(),{type:"application/wasm"});i.handle=!1,k([i])});document.addEventListener("paste",e=>{try{if(!e.clipboardData.files.length)return;const t=Array.from(e.clipboardData.files).filter(r=>r.type==="application/wasm"||r.name.endsWith(".wasm"));k(t)}catch(t){console.error(t.name,t.message)}});N.addEventListener("click",e=>{S.querySelectorAll("input").forEach(t=>{t.checked=e.target.checked})});S.addEventListener("click",async e=>{if(e.target.nodeName.toLowerCase()!=="code"){e.target.checked||(N.checked=!1);return}e.preventDefault();const r=e.target.closest("a");if(!r.classList.contains("file-name")||r.classList.contains("error")||r.classList.contains("processing"))return;const n=r.dataset.uuid,{file:s}=P.get(n);try{await K(s,{fileName:s.name,extensions:[".wasm"],mimeTypes:["application/wasm"]})}catch(a){if(a.name==="AbortError")return;console.error(a.name,a.message)}});ge.addEventListener("click",async()=>{try{const t=(await V({recursive:!0,mode:"readwrite"})).filter(r=>r.type==="application/wasm"||r.name.endsWith(".wasm"));k(t)}catch(e){if(e.name==="AbortError")return;console.error(e.name,e.message)}});we.addEventListener("click",async()=>{try{const e=await H({mimeTypes:["application/wasm"],extensions:[".wasm"],multiple:!0});if(!e||!e.length)return;k(e)}catch(e){if(e.name==="AbortError")return;console.error(e.name,e.message)}});g.addEventListener("dragover",e=>{e.preventDefault()});g.addEventListener("dragenter",e=>{g.classList.add("drag-hover")});g.addEventListener("dragleave",e=>{g.classList.remove("drag-hover")});g.addEventListener("drop",async e=>{e.preventDefault(),g.classList.remove("drag-hover");const t=[...e.dataTransfer.items].filter(n=>n.kind==="file").map(n=>x?n.getAsFileSystemHandle():n.webkitGetAsEntry()),r=[];for await(const n of t){if(n.kind==="directory"){let a=await O(n,!0);a=a.filter(i=>i.type==="application/wasm"||i.name.endsWith(".wasm")),r.push(...a);continue}else if(n.isDirectory){let a=await me(n);a=a.filter(i=>i.name.endsWith(".wasm")),r.push(...await Promise.all(a.map(async i=>new Promise(o=>i.file(o)))));continue}let s;n.kind==="file"?(s=await n.getFile(),s.handle=n):n.isFile&&(s=await new Promise(a=>n.file(i=>a(i)))),!(s.type&&s.type!=="application/wasm"||!s.name.endsWith(".wasm"))&&r.push(s)}w&&w&&R.checked&&await Le(r),k(r)});const M=e=>{const t=document.querySelector("meta[name=theme-color]");if(e.matches){t.content="rgb(32, 33, 36)";return}t.content="#fff"};matchMedia("(prefers-color-scheme: dark)").addEventListener("change",M);M(matchMedia("(prefers-color-scheme: dark)"));const x="getAsFileSystemHandle"in DataTransferItem.prototype,$="FileSystemObserver"in window;(async()=>{if($&&v(()=>import("./file-system-observer-Q3Q1vaay.js"),__vite__mapDeps([])),x&&w&&v(()=>import("./drag-and-drop-W0UyhSKZ.js"),__vite__mapDeps([])),"launchQueue"in window&&"files"in LaunchParams.prototype&&v(()=>import("./file-handling-1KWSUDH0.js"),__vite__mapDeps([])),"serviceWorker"in navigator){const{registerSW:e}=await v(()=>import("./virtual_pwa-register-zQbDOvYJ.js"),__vite__mapDeps([]));e({onOfflineReady(){},onNeedRefresh(){location.reload()}})(),v(()=>import("./web-share-target-s7SOP6vA.js"),__vite__mapDeps([]))}})();export{v as _,k as a,R as b,Le as c,xe as d,w as e,Ee as o,P as u};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}