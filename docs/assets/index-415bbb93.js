(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();const v=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{top.window.document._=0}catch{return!1}return"showOpenFilePicker"in self})(),T=v?Promise.resolve().then(function(){return _}):Promise.resolve().then(function(){return O});async function E(...e){return(await T).default(...e)}v?Promise.resolve().then(function(){return x}):Promise.resolve().then(function(){return M});v?Promise.resolve().then(function(){return I}):Promise.resolve().then(function(){return D});const L=async e=>{const t=await e.getFile();return t.handle=e,t};var A=async(e=[{}])=>{Array.isArray(e)||(e=[e]);const t=[];e.forEach((i,s)=>{t[s]={description:i.description||"Files",accept:{}},i.mimeTypes?i.mimeTypes.map(o=>{t[s].accept[o]=i.extensions||[]}):t[s].accept["*/*"]=i.extensions||[]});const r=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:t,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),n=await Promise.all(r.map(L));return e[0].multiple?n:n[0]},_={__proto__:null,default:A};function w(e){function t(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var n=r.done;return Promise.resolve(r.value).then(function(i){return{value:i,done:n}})}return w=function(r){this.s=r,this.n=r.next},w.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(r){var n=this.s.return;return n===void 0?Promise.resolve({value:r,done:!0}):t(n.apply(this.s,arguments))},throw:function(r){var n=this.s.return;return n===void 0?Promise.reject(r):t(n.apply(this.s,arguments))}},new w(e)}const S=async(e,t,r=e.name,n)=>{const i=[],s=[];var o,a=!1,c=!1;try{for(var u,d=function(l){var p,f,y,h=2;for(typeof Symbol<"u"&&(f=Symbol.asyncIterator,y=Symbol.iterator);h--;){if(f&&(p=l[f])!=null)return p.call(l);if(y&&(p=l[y])!=null)return new w(p.call(l));f="@@asyncIterator",y="@@iterator"}throw new TypeError("Object is not async iterable")}(e.values());a=!(u=await d.next()).done;a=!1){const l=u.value,p=`${r}/${l.name}`;l.kind==="file"?s.push(l.getFile().then(f=>(f.directoryHandle=e,f.handle=l,Object.defineProperty(f,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>p})))):l.kind!=="directory"||!t||n&&n(l)||i.push(S(l,t,p,n))}}catch(l){c=!0,o=l}finally{try{a&&d.return!=null&&await d.return()}finally{if(c)throw o}}return[...(await Promise.all(i)).flat(),...await Promise.all(s)]};var B=async(e={})=>{e.recursive=e.recursive||!1,e.mode=e.mode||"read";const t=await window.showDirectoryPicker({id:e.id,startIn:e.startIn,mode:e.mode});return(await(await t.values()).next()).done?[t]:S(t,e.recursive,void 0,e.skipDirectory)},x={__proto__:null,default:B},F=async(e,t=[{}],r=null,n=!1,i=null)=>{Array.isArray(t)||(t=[t]),t[0].fileName=t[0].fileName||"Untitled";const s=[];let o=null;if(e instanceof Blob&&e.type?o=e.type:e.headers&&e.headers.get("content-type")&&(o=e.headers.get("content-type")),t.forEach((u,d)=>{s[d]={description:u.description||"Files",accept:{}},u.mimeTypes?(d===0&&o&&u.mimeTypes.push(o),u.mimeTypes.map(l=>{s[d].accept[l]=u.extensions||[]})):o?s[d].accept[o]=u.extensions||[]:s[d].accept["*/*"]=u.extensions||[]}),r)try{await r.getFile()}catch(u){if(r=null,n)throw u}const a=r||await window.showSaveFilePicker({suggestedName:t[0].fileName,id:t[0].id,startIn:t[0].startIn,types:s,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1});!r&&i&&i(a);const c=await a.createWritable();return"stream"in e?(await e.stream().pipeTo(c),a):"body"in e?(await e.body.pipeTo(c),a):(await c.write(await e),await c.close(),a)},I={__proto__:null,default:F},N=async(e=[{}])=>(Array.isArray(e)||(e=[e]),new Promise((t,r)=>{const n=document.createElement("input");n.type="file";const i=[...e.map(c=>c.mimeTypes||[]),...e.map(c=>c.extensions||[])].join();n.multiple=e[0].multiple||!1,n.accept=i||"",n.style.display="none",document.body.append(n);const s=c=>{typeof o=="function"&&o(),t(c)},o=e[0].legacySetup&&e[0].legacySetup(s,()=>o(r),n),a=()=>{window.removeEventListener("focus",a),n.remove()};n.addEventListener("click",()=>{window.addEventListener("focus",a)}),n.addEventListener("change",()=>{window.removeEventListener("focus",a),n.remove(),s(n.multiple?Array.from(n.files):n.files[0])}),"showPicker"in HTMLInputElement.prototype?n.showPicker():n.click()})),O={__proto__:null,default:N},z=async(e=[{}])=>(Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise((t,r)=>{const n=document.createElement("input");n.type="file",n.webkitdirectory=!0;const i=o=>{typeof s=="function"&&s(),t(o)},s=e[0].legacySetup&&e[0].legacySetup(i,()=>s(r),n);n.addEventListener("change",()=>{let o=Array.from(n.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(o=o.filter(a=>a.webkitRelativePath.split("/").every(c=>!e[0].skipDirectory({name:c,kind:"directory"})))):o=o.filter(a=>a.webkitRelativePath.split("/").length===2),i(o)}),"showPicker"in HTMLInputElement.prototype?n.showPicker():n.click()})),M={__proto__:null,default:z},q=async(e,t={})=>{Array.isArray(t)&&(t=t[0]);const r=document.createElement("a");let n=e;"body"in e&&(n=await async function(o,a){const c=o.getReader(),u=new ReadableStream({start:p=>async function f(){return c.read().then(({done:y,value:h})=>{if(!y)return p.enqueue(h),f();p.close()})}()}),d=new Response(u),l=await d.blob();return c.releaseLock(),new Blob([l],{type:a})}(e.body,e.headers.get("content-type"))),r.download=t.fileName||"Untitled",r.href=URL.createObjectURL(await n);const i=()=>{typeof s=="function"&&s()},s=t.legacySetup&&t.legacySetup(i,()=>s(),r);return r.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(r.href),3e4),i()}),r.click(),null},D={__proto__:null,default:q};const R=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],U=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],j=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],H=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],b=(e,t,r)=>{let n=e;return typeof t=="string"||Array.isArray(t)?n=e.toLocaleString(t,r):(t===!0||r!==void 0)&&(n=e.toLocaleString(void 0,r)),n};function g(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);t={bits:!1,binary:!1,space:!0,...t};const r=t.bits?t.binary?H:j:t.binary?U:R,n=t.space?" ":"";if(t.signed&&e===0)return` 0${n}${r[0]}`;const i=e<0,s=i?"-":t.signed?"+":"";i&&(e=-e);let o;if(t.minimumFractionDigits!==void 0&&(o={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(o={maximumFractionDigits:t.maximumFractionDigits,...o}),e<1){const d=b(e,t.locale,o);return s+d+n+r[0]}const a=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),r.length-1);e/=(t.binary?1024:1e3)**a,o||(e=e.toPrecision(3));const c=b(Number(e),t.locale,o),u=r[a];return s+c+n+u}const $=document.querySelector("#load-wasm");document.querySelector("#before-size");document.querySelector("#after-size");document.querySelector("#delta-size");const m=document.querySelector("#drop-area"),P=document.querySelector("#results-area"),Y=document.querySelector("#stats-template");async function W(e,t){const r=[];async function n(s){for(const[o,a]of s)try{r[o]=await a()}catch(c){r[o]=new Error(`Failed with: ${c.message}`)}}const i=new Array(t).fill(e.entries()).map(n);return await Promise.allSettled(i),r}const C="getAsFileSystemHandle"in DataTransferItem.prototype;$.addEventListener("click",G);const k=async e=>{P.innerHTML="";const t=[];for(const n of e){console.log("Running",n);const i=Y.content.cloneNode(!0),s=i.querySelector(".file-name"),o=i.querySelector(".before-size"),a=i.querySelector(".after-size"),c=i.querySelector(".delta-size");s.textContent=n.name,o.textContent=g(n.size),P.append(i),t.push(()=>new Promise((u,d)=>{const l=new Worker(new URL("/assets/worker-3fb90079.js",self.location),{type:"module"});console.log(l),l.addEventListener("message",p=>{const{file:f}=p.data;console.log(f),a.textContent=g(f.size);const y=f.size-n.size;c.textContent=g(y),y<0?c.classList.add("size-smaller"):y>=0&&c.classList.add("size-larger"),l.close(),u()}),l.postMessage({wasmFile:n})}))}console.log(t);const r=await W(t,Math.min(t.length,3));console.log(r)};async function G(){const e=await E({mimeTypes:["application/wasm"],extensions:[".wasm"],multiple:!0});!e||!e.length||k(e)}m.addEventListener("dragover",e=>{e.preventDefault()});m.addEventListener("dragenter",e=>{m.style.outline="solid red 1px"});m.addEventListener("dragleave",e=>{m.style.outline=""});m.addEventListener("drop",async e=>{e.preventDefault(),m.style.outline="";const t=[...e.dataTransfer.items].filter(n=>n.kind==="file").map(n=>C?n.getAsFileSystemHandle():n.getAsFile()),r=[];for await(const n of t){let i=n;n.kind==="file"&&(i=await n.getFile()),i.type==="application/wasm"&&r.push(i)}k(r)});
