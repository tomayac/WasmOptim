import{d as u,o as a,u as d,s as c,a as h}from"./index-03b0cf75.js";let e=null;const g=async n=>{const o=[];for(const t of n)if(t.type==="modified"){const s=await t.changedHandle.getFile();console.log(`${s.name} modified â†’ Re-optimizing`),s.handle=t.changedHandle;const l=c?await t.changedHandle.getUniqueId():t.changedHandle.name;o.push(s);for(const[r,{handle:i}]of d.entries())(c?await i.getUniqueId():i.name)===l&&document.querySelector(`[data-uuid="${r}"]`)?.closest("tr")?.remove()}h(o)},f=()=>(e||(e=new FileSystemObserver(u(n=>{g(n)},250))),e);a.parentNode.hidden=!1;a.addEventListener("change",()=>{if(localStorage.setItem("observe-changes",a.checked),a.checked){f();for(const[,{handle:n}]of d.entries())n&&e.observe(n);return}e&&(e.disconnect(),e=null)});localStorage.getItem("observe-changes")!=="true"?a.checked=!1:a.checked=!0;export{f as getFileSystemChangeObserver};
