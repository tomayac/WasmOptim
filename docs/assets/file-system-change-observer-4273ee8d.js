import{d as r,o as a,u as c,a as u}from"./index-adfc6881.js";let e=null;const h=async n=>{const i=[];for(const t of n)if(t.type==="modified"){const o=await t.changedHandle.getFile();console.log(`File modified, re-optimizing ${o.name}.`),o.handle=t.changedHandle;const d=await t.changedHandle?.getUniqueId()||t.changedHandle.name;i.push(o);for(const[l,{handle:s}]of c.entries())(await s?.getUniqueId()||s.name)===d&&document.querySelector(`[data-uuid="${l}"]`)?.closest("tr")?.remove()}u(i)},g=()=>(e||(e=new FileSystemObserver(r(n=>{h(n)},250))),e);a.parentNode.hidden=!1;a.addEventListener("change",()=>{if(localStorage.setItem("observe-changes",a.checked),a.checked){g();for(const[,{handle:n,file:i}]of c.entries())n&&e.observe(n);return}e&&(e.disconnect(),e=null)});localStorage.getItem("observe-changes")!=="true"?a.checked=!1:a.checked=!0;export{g as getFileSystemChangeObserver};
